/**
*
*   Asynchronous.js
*   @version: 0.5.0
*
*   Simple JavaScript class to manage asynchronous, parallel, linear, sequential and interleaved tasks
*   https://github.com/foo123/asynchronous.js
*
**/
!function(n,e,t){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils["import"]?(n.$deps=n.$deps||{})&&(n.EXPORTED_SYMBOLS=[e])&&(n[e]=n.$deps[e]=t.call(n)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[e]=t.call(n)):"undefined"!=typeof System&&"function"==typeof System.register&&"function"==typeof System["import"]?System.register(e,[],function(r){r(e,t.call(n))}):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(e)?define(e,["module"],function(e){return t.moduleUri=e.uri,t.call(n)}):e in n||(n[e]=t.call(n)||1)&&"function"==typeof define&&define.amd&&define(function(){return n[e]})}(this,"Asynchronous",function n(e){"use strict";function t(n){var e,t=[];if(n)for(e in n)n[f](e)&&t.push(e+"="+(!0===n[e]||1===n[e]?"yes":!1===n[e]||0===n[e]?"no":n[e]));return t.join(",")}function r(n,e){n.$runmode=x,n.$running=!1}function o(n,e){var t,r=n,o=r.$queue;if(r.$runmode=R,o){for(;o.length&&(!o[0]||!o[0].canRun());)o.shift();o.length?(r.$running=!0,t=o.shift(),e?t.runWithArgs(e):t.run(),t.complete()):r.$running=!1}}function i(n,e){var t,r=n,o=r.$queue,s=0;if(r.$runmode=A,o&&o.length){for(r.$running=!0;s<o.length;)t=o[s],t&&t.canRun()?(e?t.runWithArgs(e):t.run(),t.isFinished()?(o.shift(),t.complete()):s++):o.shift();r.$running=!1,r.$timer=N(K(i,r),r.$interval)}}function s(n,e){var t,r=n,o=r.$queue;r.$runmode=L,o&&o.length&&(t=o[0],t&&t.canRun()?(r.$running=!0,e?t.runWithArgs(e):t.run(),t.isFinished()&&(o.shift(),t.complete())):o.shift(),r.$running=!1,r.$timer=N(K(s,r),r.$interval))}var u,l,c,a="prototype",f="hasOwnProperty",p=Object,d=Array,h=Function,m=h[a],$=p[a],g=d[a],v=function(){},w=m.call.bind(g.slice),y=$.toString,b=function(n){return"function"==typeof n},S=function(n,e){return n instanceof e},N=setTimeout,k=clearTimeout,E=e,j=0,T=1,M=2,q=60,W=0,A=1,R=2,x=3,L=4,O="undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils["import"],C="undefined"!=typeof global&&"[object global]"===y.call(global),I=C&&"undefined"!=typeof process.send,U=!O&&!C&&"undefined"!=typeof SharedWorkerGlobalScope&&"function"==typeof importScripts,B=!O&&!C&&"undefined"!=typeof WorkerGlobalScope&&"function"==typeof importScripts&&navigator instanceof WorkerNavigator,D=!(O||C||B||U||"undefined"==typeof navigator||"undefined"==typeof document),F=(D&&!!window.opener,D&&window.self!==window.top,"function"==typeof define&&define.amd),P=C||"function"==typeof Worker||"function"==typeof SharedWorker,_=I||U||B,z=C?this:U||B?self:window,G=C?module.$deps:U||B?self:window,J=C?global:U||B?self:window,V=(C?require("os").cpus().length:4,JSON.parse,JSON.stringify),K=function(n,e){return function(){return n(e)}},Q="undefined"!=typeof z.webkitURL?z.webkitURL:"undefined"!=typeof z.URL?z.URL:null,X=function(n,e){return n&&Q?Q.createObjectURL(new Blob(n.push?n:[n],e||{type:"text/javascript"})):n},Y=function an(n){var e;return C?{file:__filename,path:__dirname}:U||B?{file:e=self.location.href,path:e.split("/").slice(0,-1).join("/")}:F&&n?{file:e=n,path:e.split("/").slice(0,-1).join("/")}:D&&(e=document.getElementsByTagName("script"))&&e.length?(an.link||(an.link=document.createElement("a")),an.link.href=e[e.length-1].src,e=an.link.href,{file:e,path:e.split("/").slice(0,-1).join("/")}):{path:null,file:null}},H=Y(n.moduleUri),Z=H.file,nn=function(n){return!(!n||!n.length||n===Z)},en=function(n,e){if(n=n||{},e)for(var t in e)e[f](t)&&(n[t]=e[t]);return n},tn=0;if(U?(z.close=function(){},z.postMessage=function(n){},l=function fn(n){c?(n&&c.addEventListener("message",n),fn.handler=null):n&&(fn.handler=n)},z.onconnect=function(n){c=n.ports[0],z.close=function(){c.close()},z.postMessage=function(n){c.postMessage(n)},l.handler&&(c.addEventListener("message",l.handler),l.handler=null),c.start()}):l=B?function(n){n&&(z.onmessage=n)}:I?function pn(n){if(n){pn.handler&&(process.removeListener("message",pn.handler),pn.handler=null);var e;process.on("message",e=function(e){n(e)}),pn.handler=e}}:v,C){var rn=require("fs"),on=require("child_process");_&&(z.close=function(){process.exit()},z.postMessage=function(n){process.send({data:n})},z.importScripts=function(n){if(n&&(n=n.split(",")).length)for(var e,t=0;t<n.length;){e=!0;try{new Function("",rn.readFileSync(n[t]).toString()).call(G)}catch(r){e=r}if(!0!==e)throw e;t++}}),u=function(n){var e=this;e.process=on.fork(n,[],{silent:!0}),e.process.on("message",function(n){e.onmessage&&e.onmessage(n)}),e.process.on("error",function(n){e.onerror&&e.onerror(n)})},u.Shared=u,u[a]={constructor:u,process:null,onmessage:null,onerror:null,postMessage:function(n){return this.process&&this.process.send({data:n}),this},terminate:function(){return this.process&&(this.process.kill(),this.process=null),this}}}else u=function(n){var e=this;e.process=new Worker(n),e.process.onmessage=function(n){e.onmessage&&e.onmessage(n)},e.process.onerror=function(n){e.onerror&&e.onerror(n)}},u.Shared=u,u[a]={constructor:u,process:null,onmessage:null,onerror:null,postMessage:function(n){return this.process&&this.process.postMessage(n),this},terminate:function(){return this.process&&(this.process.terminate(),this.process=null),this}},"function"==typeof SharedWorker&&(u.Shared=function(n){var e=this;e.process=new SharedWorker(n),e.process.port.start(),e.process.port.onmessage=function(n){e.onmessage&&e.onmessage(n)},e.process.port.onerror=e.process.onerror=function(n){e.onerror&&e.onerror(n)}},u.Shared[a]={constructor:u.Shared,process:null,onmessage:null,onerror:null,postMessage:function(n){return this.process&&this.process.port.postMessage(n),this},terminate:function(){return this.process&&(this.process.port.close(),this.process=null),this}});var sn=function dn(n){var e=this;return e instanceof dn?(e.$id=(++tn).toString(16),void(e.options=en({width:400,height:400,toolbar:0,location:0,directories:0,status:0,menubar:0,scrollbars:1,resizable:1},n))):new dn(n)};sn[a]={constructor:sn,options:null,$id:null,$window:null,dispose:function(){var n=this;return n.$window&&n.close(),n.$window=null,n.$id=null,n.options=null,n},close:function(){var n=this;return n.$window&&(n.$window.closed||n.$window.close(),n.$window=null),n},ready:function(n,e){var t=this,r=function o(){!t.$window||n&&!t.$window[n]?setTimeout(o,50):e()};return setTimeout(r,0),t},open:function(n){var e=this;return!e.$window&&n&&(e.$window=window.open(n.push?X(["\ufeff"].concat(n),{type:"text/html;charset=utf-8"}):n,e.$id,t(e.options))),e},write:function(n){var e=this;return e.$window&&n&&e.$window.document.write(n),e}};var un=function hn(n){if(n instanceof hn)return n;if(!(this instanceof hn))return new hn(n);var t,r=this,o=null,i=null,s=null,u=!1,l=!1,c=!1,a=!1,f=!1,p=!1,d=null,h=0,m=1,$=null,g=null,v=null,w=e;r.queue=function(n){return arguments.length?(o=n,r):o},r.jumpNext=function(n){o&&o.jumpNext(!1,n)},r.abort=function(n){o&&(o.abort(!1),n&&(o.dispose(),o=null))},r.dispose=function(){o&&(o.dispose(),o=null)},r.task=function(n){return i=n,r},n&&r.task(n),r.run=t=function(){return i.jumpNext=r.jumpNext,i.abort=r.abort,i.dispose=r.dispose,w=i(),u=!0,i.jumpNext=null,i.abort=null,i.dispose=null,w},r.runWithArgs=function(n){return i.jumpNext=r.jumpNext,i.abort=r.abort,i.dispose=r.dispose,w=i.apply(null,n),u=!0,i.jumpNext=null,i.abort=null,i.dispose=null,w},r.canRun=function(){return i&&(!u||l||c||a||f||p)?(l||c)&&h>=$?!1:c&&!d?!1:!a&&!f||w!==g:!1},r.iif=function(n,e,t){return n?r.task(e):arguments.length>2&&r.task(t),r},r.until=function(n){return w=e,d=null,g=n,f=!0,p=!1,l=!1,c=!1,a=!1,r.run=t,r},r.untilNot=function(n){return w=e,d=null,v=n,p=!0,f=!1,l=!1,c=!1,a=!1,r.run=t,r},r.loop=function(n,t,o){return w=e,d=null,h=t||0,m=o||1,$=n,l=!0,f=!1,p=!1,c=!1,a=!1,r.run=function(){var n;return n=i(h),h+=m,w=n,u=!0,n},r},r.each=function(n){return w=e,d=n,h=0,m=1,$=n?n.length||0:0,c=!0,f=!1,p=!1,l=!1,a=!1,r.run=function(){var n;return n=i(d[h],h),h++,w=n,u=!0,n},r},r.recurse=function(n,e){return d=null,w=n,g=e,a=!0,f=!1,p=!1,l=!1,c=!1,r.run=function(){var n;return n=i(w),w=n,u=!0,n},r},r.isFinished=function(){var n=!u||p||f||l||c||a;return n&&(f||a)&&w===g&&(n=!1),n&&p&&w!==v&&(n=!1),n&&(l||c)&&h>=$&&(n=!1),!n},r.onComplete=function(n){return s=n||null,r},r.complete=function(){return s&&b(s)&&s(),r}},ln=function mn(n,e){if(S(n,un))return n;if(b(n))return new un(n);if(!S(this,mn))return new mn(n,e);var t=this;t.$interval=arguments.length?parseInt(n,10)||q:q,t.$timer=null,t.$runmode=W,t.$running=!1,t.$queue=[],_&&!1!==e&&t.initThread()};if(ln.VERSION="0.5.0",ln.Thread=u,ln.Task=un,ln.BrowserWindow=sn,ln.MODE={NONE:W,INTERLEAVE:A,LINEAR:R,PARALLEL:x,SEQUENCE:L},ln.Platform={UNDEFINED:E,UNKNOWN:j,NODE:T,BROWSER:M},ln.supportsMultiThreading=function(){return P},ln.isPlatform=function(n){return T===n?C:M===n?D:e},ln.isThread=function(n){return T===n?I:M===n?U||B:_},ln.path=Y,ln.blob=X,ln.load=function(n,e,t){if(n){var r=function(){n=n.split(".");for(var e=G;n.length;)n[0]&&n[0].length&&e[n[0]]&&(e=e[n[0]]),n.shift();return e&&z!==e?b(e)?!1!==t?new e:e():e:void 0};return e&&e.length&&(e=e.filter(nn),e.length&&ln.importScripts(e.join(","))),r()}return null},ln.postMessage=_?function(n){z.postMessage(n)}:v,ln.importScripts=_?function(n){z.importScripts(n)}:v,ln.close=_?function(){z.close()}:v,ln.log="undefined"!=typeof console?function(n){console.log(n||"")}:v,ln.serialize=function(n){n=n||new ln;var e=function(e){var t=function(){var t=this,r=arguments;n.step(function(){e.apply(t,r)}),n.$running||n.run(R)};return t.free=function(){return e},t};return e.free=function(){n&&n.dispose(),n=null},e},ln[a]={constructor:ln,$interval:q,$timer:null,$queue:null,$thread:null,$events:null,$runmode:W,$running:!1,dispose:function(n){var e=this;return e.unfork(!0),e.$timer&&k(e.$timer),e.$thread=null,e.$timer=null,e.$interval=null,e.$queue=null,e.$runmode=W,e.$running=!1,_&&!0===n&&ln.close(),e},empty:function(){var n=this;return n.$timer&&k(n.$timer),n.$timer=null,n.$queue=[],n.$runmode=W,n.$running=!1,n},interval:function(n){return arguments.length?(this.$interval=parseInt(n,10)||this.$interval,this):this.$interval},fork:function(n,e,t,r){var o,i,s,l=this;if(!l.$thread){if(!P)throw l.$thread=null,new Error("Asynchronous: Multi-Threading is NOT supported!");C?(i="Asynchronous: Thread (Process): ",s="Asynchronous: Thread (Process) Error: "):(i="Asynchronous: Thread (Worker): ",s="Asynchronous: Thread (Worker) Error: "),l.$events=l.$events||{},o=l.$thread=!0===r?new u.Shared(Z):new u(Z),o.onmessage=function(n){if(n.data.event){var e=n.data.event,t=n.data.data||null;l.$events&&l.$events[e]?l.$events[e](t):"console.log"!==e&&"console.error"!==e||ln.log(i+(t.output||""))}},o.onerror=function(n){if(!l.$events||!l.$events.error)throw new Error(s+n.message+" file: "+n.filename+" line: "+n.lineno);l.$events.error(n)},l.send("initThread",{component:n||null,asInstance:!1!==t,imports:e?[].concat(e):null})}return l},unfork:function(n){var e=this;return e.$thread&&(!0===n?e.$thread.terminate():e.send("dispose")),e.$thread=null,e.$events=null,e},initThread:function(){var n=this;return _&&(n.$events={},l(function(e){var t=e.data.event,r=e.data.data||null;t&&n.$events[t]?n.$events[t](r):"dispose"===t&&(n.dispose(),ln.close())})),n},listen:function(n,e){return n&&b(e)&&this.$events&&(this.$events[n]=e),this},unlisten:function(n,e){return n&&this.$events&&this.$events[n]&&(2>arguments.length||e===this.$events[n])&&delete this.$events[n],this},send:function(n,e){return n&&(_?ln.postMessage({event:n,data:e||null}):this.$thread&&this.$thread.postMessage({event:n,data:e||null})),this},task:function(n){return S(n,un)?n:b(n)?un(n):void 0},iif:function(){var n=arguments,e=new un;return e.iif.apply(e,n)},until:function(){var n=w(arguments),e=new un(n.pop());return e.until.apply(e,n)},untilNot:function(){var n=w(arguments),e=new un(n.pop());return e.untilNot.apply(e,n)},loop:function(){var n=w(arguments),e=new un(n.pop());return e.loop.apply(e,n)},each:function(){var n=w(arguments),e=new un(n.pop());return e.each.apply(e,n)},recurse:function(){var n=w(arguments),e=new un(n.pop());return e.recurse.apply(e,n)},step:function(n){var e=this;return n&&e.$queue.push(e.task(n).queue(e)),e},steps:function(){var n,e,t=this,r=arguments;for(e=r.length,n=0;e>n;n++)t.step(r[n]);return t},jumpNext:function(n,e){var t=this,r=t.$queue;return e=e||0,!1!==n?function(){return e<r.length&&(e>0&&r.splice(0,e),t.run(t.$runmode)),t}:(e<r.length&&(e>0&&r.splice(0,e),t.run(t.$runmode)),t)},jumpNextWithArgs:function(n,e,t){var r=this,o=r.$queue;return e=e||0,!1!==n?function(){return e<o.length&&(e>0&&o.splice(0,e),r.run(r.$runmode,arguments)),r}:(e<o.length&&(e>0&&o.splice(0,e),r.run(r.$runmode,t)),r)},abort:function(n,e){var t=this;return!1!==n?function(){return e&&e>0?N(function(){t.empty()},e):t.empty(),t}:(e&&e>0?N(function(){t.empty()},e):t.empty(),t)},run:function(n,e){var t=this;return arguments.length?t.$runmode=n:n=t.$runmode,e=e||null,L===n?s(t,e):A===n?i(t,e):R===n?o(t,e):x===n&&r(t,e),t}},_){var cn=null;J.console={log:function(n){ln.postMessage({event:"console.log",data:{output:n||""}})},error:function(n){ln.postMessage({event:"console.error",data:{output:n||""}})}},ln.log=function(n){J.console.log("string"!=typeof n?V(n):n)},l(function(n){var e=n.data.event,t=n.data.data||null;switch(e){case"initThread":t&&t.component&&(cn&&(b(cn.dispose)&&cn.dispose(),cn=null),cn=ln.load(t.component,t.imports,t.asInstance));break;case"dispose":default:cn&&(b(cn.dispose)&&cn.dispose(),cn=null),ln.close()}})}return ln});